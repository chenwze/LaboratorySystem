<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <meta charset="UTF-8">
    <title>预约实验室信息表</title>
    <link rel="stylesheet" href="../../static/layui/css/layui.css" th:href="@{/layui/css/layui.css}">
    <script src="../../static/js/jquery-3.6.0.min.js" th:src="@{/js/jquery-3.6.0.min.js}" type="text/javascript"></script>
    <script src="../../static/layui/layui.js" th:src="@{/layui/layui.js}" type="text/javascript"></script>
</head>
<style>
    body .demo-class .layui-layer-btn0{
        border-color: #E6E3E6;
        background-color: #FFF;
        color: black;
    }
    body .demo-class .layui-layer-btn1{
        border-color: #4898d5;
        background-color: #2e8ded;
        color: #fff;
    }
    body .layui-ext-myskin .layui-layer-btn0{
        　　border-color: #55ff83;
        　　background-color: #5aff53;
        　　color: #4736ff;
    }
    .btttt{
        color: #fff;
    }
    input:focus
    {
        background:rgba(216,54,54,0.5);
    }
</style>
<body>
    <form th:action="@{/student/addReserve}" th:method="post" >
        <div class="layui-form-item"  style="text-align: center;">
            <div class="layui-inline">
                <label class="layui-form-label">实验楼</label>
                <div class="layui-input-inline">
                    <input th:value="${laboratoryInfo.laboratoryInfo.buildingName}" disabled required lay-verify="required"  autocomplete="on" class="layui-input">
                </div>
            </div>
            <!--    <div class="layui-form-mid layui-word-aux">辅助文字</div>-->

            <div class="layui-inline">
                <label class="layui-form-label">实验房间号</label>
                <div class="layui-input-inline">
                    <input th:value="${laboratoryInfo.laboratoryInfo.roomNumber}" disabled required lay-verify="required"  autocomplete="on" class="layui-input">
                </div>
            </div>
            <!--    <div class="layui-form-mid layui-word-aux">辅助文字</div>-->

            <div class="layui-inline">
                <label class="layui-form-label">可容纳数</label>
                <div class="layui-input-inline">
                    <input th:value="${laboratoryInfo.laboratoryInfo.capacity}" disabled required lay-verify="required"  autocomplete="on" class="layui-input">
                </div>
            </div>
            <!--    <div class="layui-form-mid layui-word-aux">辅助文字</div>-->

            <div class="layui-inline">
                <label class="layui-form-label">实验室类别</label>
                <div class="layui-input-inline">
                    <input th:value="${laboratoryInfo.laboratoryInfo.category}" disabled required lay-verify="required"  autocomplete="on" class="layui-input">
                </div>
            </div>

            <div class="layui-inline input-focus">
                <label class="layui-form-label input-focus">预约时间</label>
                <div class="layui-input-inline">
                    <input id="reserve-date" th:value="${reserve}" required="required" name="reserveTime" class="layui-input" readonly lay-verify="required|date" type="data" placeholder="预约时间"  >
                </div>
            </div>
            <!--    <div class="layui-form-mid layui-word-aux">辅助文字</div>-->

            <div class="layui-inline" style="visibility:hidden;" >
                <label class="layui-form-label">实验室编号</label>
                <div class="layui-input-inline">
                    <input  th:value="${laboratoryInfo.laboratoryInfo.labid}" name="labid" class="layui-input" readonly lay-verify="required|date" type="data" placeholder="预约时间"  >
                </div>
            </div>
<!--                <div class="layui-form-mid layui-word-aux">辅助文字</div>-->
        </div>

        <div class="" style="text-align: center; ">
            <h2 >实验室说明</h2>
            <p style="padding:10px;border: 1px silver solid; margin: 0 auto;width: 78%;text-align: left;">[[${laboratoryInfo.laboratoryInfo.describe}]]</p>
        </div>
        <div style="width: 78%;margin:0 auto;margin-top: 15px;">
            <div style="display: inline-block;float: right">
                    <button id="reserve-btn" type="submit" class="layui-btn layui-btn-normal" >保存</button>
                <button onclick="closeIfame();" type="" class="layui-btn layui-btn-normal">取消</button>
            </div>
        </div>
    </form>
<!--<div class="layui-input-inline">-->
<!--    <input id="reserve-date" th:value="${reserve}" name="reserve" class="layui-input" readonly lay-verify="required|date" type="data" placeholder="预约时间"  >-->
<!--</div>-->
<!--<div class="layui-input-inline">-->
<!--    <input id="reserve-date" th:value="${reserve}" name="reserve" class="layui-input" readonly lay-verify="required|date" type="data" placeholder="预约时间"  >-->
<!--</div>-->
<!--<div class="layui-input-inline">-->
<!--    <input id="reserve-date" th:value="${reserve}" name="reserve" class="layui-input" readonly lay-verify="required|date" type="data" placeholder="预约时间"  >-->
<!--</div>-->
<!--<button onclick="getParam();">sss</button>-->
<span id="reserveTimeList" style="display: none;">[[${laboratoryInfo.reserveTimeList}]]</span>

</body>
<script type="text/javascript">
    //日期插件
    layui.use('laydate', function() {
        var reserveTimeList=document.getElementById("reserveTimeList");
        // console.log(reserveTimeList.innerText);
        var markJson = new Function("return" + reserveTimeList.innerText)();//转换后的JSON对象
        console.log(markJson);
        function disabled_date() {
            if (markJson != null) {
                for (var key in markJson) {
                    var dates = key.split("-");
                    // dates[1] = dates[1] * 1;
                    var mm = dates[0] + '-' + parseInt(dates[1]) + '-' + parseInt(dates[2]);
                    console.log(mm);
                    $('.laydate-theme-grid table tbody').find('[lay-ymd="' + mm + '"]').addClass('laydate-disabled');
                    // keys.push(key);
                }
            }

        }

        var laydate = layui.laydate;
        laydate.render({
            elem: '#reserve-date',
            min: 1,
            trigger: 'click',
            theme: 'grid',
            showBottom: false,
            ready: function (value) {//控件在打开时触发，回调返回一个参数
                disabled_date(); //得到初始的日期时间对象：{year: 2017, month: 8, date: 18, hours: 0, minutes: 0, seconds: 0}
            },
            change: function (value, date) { //监听日期被切换
                disabled_date();
                //执行函数
            }
        });
    })

    //关闭弹窗
    function closeIfame() {
        //使用data获取传送过的obj参数
        //在子页面关闭弹出层
        var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
        parent.layer.close(index); //再执行关闭
    }


    // layui.use("layer", function () {
    //     var layer = layui.layer;
    //     $("#reserve-btn").click(function () {
    //         layer.open({
    //             type: 3,
    //             // area: ['100%', '100%']
    //         });
    //     });
    // });

    //判断表单input是否有空值
    $(document).ready(function(){
        $("form").submit(function(e) {
            var ref = $(this).find("[required=required]");
            // alert('ref');
            $(ref).each(function(){
                if ( $(this).val() == '' )
                {
                    // alert("Required field should not be blank.");
                    $(this).focus();
                    e.preventDefault();
                    return false;
                }
            });
            return true;
        });
    });
</script>

</html>
